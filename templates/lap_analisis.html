<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{tittle}}</title>
    <link rel="shortcut icon" href="{{ url_for('static', filename='bg/icon.png') }}" type="image/png">

    <!-- CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/grid.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/app.css') }}">
    <!-- GOOGLE FONT -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://codepen.io/naveenbhaskar/pen/WGPzQv.scss">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bxslider/4.2.12/jquery.bxslider.min.css">
    <!-- BOXICONS -->
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.js">
    </script>

</head>

<body">
    <!-- SIDEBAR -->
    <div class="sidebar">
        <div class="sidebar-logo">
            <img src="{{ url_for('static', filename='bg/icon.png') }}" alt="Comapny logo">Sentiment Analysis
            <div class="sidebar-close" id="sidebar-close">
                <i class='bx bx-left-arrow-alt'></i>
            </div>
        </div>
        <div class="sidebar-user">
            <div class="sidebar-user-info">
                <img src="{{ url_for('static', filename='bg/') }}{{session.level}}.png" alt="User picture"
                    class="profile-image">
                <div class="sidebar-user-name">
                    {{session.name}}
                    <br>
                    <h6>{{session.level}}</h6>
                </div>
            </div>
            <button class="btn btn-outline">
                <a href="/logout">
                    <i class='bx bx-log-out bx-flip-horizontal'></i>
                </a>
            </button>
        </div>
        <!-- SIDEBAR MENU -->
        {% if session.level == 'admin' %}
        <ul class="sidebar-menu">
            <li>
                <a href="/home">
                    <i class='bx bx-home'></i>
                    <span>dashboard</span>
                </a>
            </li>
            <li>
                <a href="/account">
                    <i class='bx bx-user-circle'></i>
                    <span>Account</span>
                </a>
            </li>
            <li class="sidebar-submenu">
                <a href="#" class="sidebar-menu-dropdown">
                    <i class='bx bx-message-alt-dots'></i>
                    <span>Scrapping</span>
                    <div class="dropdown-icon"></div>
                </a>
                <ul class="sidebar-menu sidebar-menu-dropdown-content">
                    <li>
                        <a href="/scrapping/instagram">
                            Instagram
                        </a>
                    </li>
                    <li>
                        <a href="/scrapping/youtube">
                            Youtube
                        </a>
                    </li>
                </ul>
            </li>
            <li class="sidebar-submenu">
                <a href="#" class="sidebar-menu-dropdown">
                    <i class='bx bx-pie-chart-alt-2'></i>
                    <span>Analysis Sentiment</span>
                    <div class="dropdown-icon"></div>
                </a>
                <ul class="sidebar-menu sidebar-menu-dropdown-content">
                    <li>
                        <a href="/analysis">
                            Analisa Dataset
                        </a>
                    </li>
                    <li>
                        <a href="/hasil">
                            Hasil Analisa Dataset
                        </a>
                    </li>
                </ul>
            </li>
            <li class="sidebar-submenu">
                <a href="#" class="sidebar-menu-dropdown">
                    <i class='bx bxs-report'></i>
                    <span>Laporan Kinerja</span>
                    <div class="dropdown-icon"></div>
                </a>
                <ul class="sidebar-menu sidebar-menu-dropdown-content">
                    <li>
                        <a href="/laporan/scrapping">
                            Scraping
                        </a>
                    </li>
                    <li>
                        <a href="/laporan/analisis" class="active">
                            Sentimen Analisis
                        </a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="#" class="darkmode-toggle" id="darkmode-toggle">
                    <i class='bx bx-moon'></i>
                    <span class="darkmode-switch"></span>
                </a>
            </li>
        </ul>
        {% else %}
        <ul class="sidebar-menu">
            <li>
                <a href="/home">
                    <i class='bx bx-home'></i>
                    <span>dashboard</span>
                </a>
            </li>
            <li class="sidebar-submenu">
                <a href="#" class="sidebar-menu-dropdown">
                    <i class='bx bx-message-alt-dots'></i>
                    <span>Scrapping</span>
                    <div class="dropdown-icon"></div>
                </a>
                <ul class="sidebar-menu sidebar-menu-dropdown-content">
                    <li>
                        <a href="/scrapping/instagram">
                            Instagram
                        </a>
                    </li>
                    <li>
                        <a href="/scrapping/youtube">
                            Youtube
                        </a>
                    </li>
                </ul>
            </li>
            <li class="sidebar-submenu">
                <a href="#" class="sidebar-menu-dropdown">
                    <i class='bx bx-pie-chart-alt-2'></i>
                    <span>Analysis Sentiment</span>
                    <div class="dropdown-icon"></div>
                </a>
                <ul class="sidebar-menu sidebar-menu-dropdown-content">
                    <li>
                        <a href="/analysis">
                            Analisa Dataset
                        </a>
                    </li>
                    <li>
                        <a href="/hasil">
                            Hasil Analisa Dataset
                        </a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="#" class="darkmode-toggle" id="darkmode-toggle">
                    <i class='bx bx-moon'></i>
                    <span class="darkmode-switch"></span>
                </a>
            </li>
        </ul>
        {% endif %}
        <!-- END SIDEBAR MENU -->
    </div>
    <!-- END SIDEBAR -->
    <!-- MAIN CONTENT -->
    <div class="main">
        <div class="main-header">
            <div class="mobile-toggle" id="mobile-toggle">
                <i class='bx bx-menu-alt-right'></i>
            </div>
            <div class="main-title">
                {{tittle1}}
            </div>
        </div>
        <div class="main-content" id="content">
            <div class="box">
                <div class="box-header">
                    <button id="btnCetak" type="submit" class="add status-button">
                        <i class='bx bx-user-plus'></i>Cetak
                    </button>
                </div>
                <div class="box-body overflow-scroll">
                    <table id="myTable">
                        <thead>
                            <tr>
                                <th rowspan="2">ID</th>
                                <th rowspan="2">User</th>
                                <th rowspan="2">Link</th>
                                <th colspan="3" style="text-align: center;">Analisa Sentimen</th>
                            </tr>
                            <tr>
                                <th>Positif</th>
                                <th>Negatif</th>
                                <th>Netral</th>
                            </tr>
                        </thead>
                        {% set count = [] %}
                        {% for d in analisis %}
                        <tbody>
                            <tr>
                                {% set __ = count.append(1) %}
                                <td>{{ count|length }}.</td>
                                <td>
                                    <div class="order-owner">
                                        <span>{{d.0}}</span>
                                    </div>
                                </td>
                                <td><a href="{{d.1}}">{{d.1}}</a></td>
                                <td>
                                    <span>{{d.2}}</span>
                                </td>
                                <td>
                                    <span>{{d.3}}</span>
                                </td>
                                <td>
                                    <span>{{d.4}}</span>
                                </td>
                            </tr>
                        </tbody>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- END MAIN CONTENT -->

    <div class="overlay"></div>

    <script type="text/javascript">
        // <![CDATA[
        function preloader() {
            document.getElementById("loading").style.display = "none";
            document.getElementById("content").style.display = "block";
        } //preloader
        window.onload = preloader;
        // ]]>
    </script>

    <script type="text/javascript">
        // <![CDATA[
        function preloader() {
            document.getElementById("loading1").style.display = "none";
            document.getElementById("content1").style.display = "block";
        } //preloader
        window.onload = preloader;
        // ]]>
    </script>

    <!-- SCRIPT -->
    <!-- APEX CHART -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bxslider/4.2.12/jquery.bxslider.min.js"></script>
    <!-- JS -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous">
    </script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.js">
    </script>
    <script>
        $(document).ready(function () {
            $('#myTable').DataTable({
                "paging": true, // Enable pagination
                "lengthMenu": [10, 25, 50, 75, 100], // Set page length options
                "searching": true, // Enable searching
                "ordering": true, // Enable sorting
            });
        });

        document.getElementById('btnCetak').addEventListener('click', function () {
            // Create a new window for the print view
            var printWindow = window.open('', '_blank');

            // Add the HTML content for the print view
            var printContent = `
        <style>
            table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 20px;
            }

            th, td {
                border: 1px solid #dddddd;
                text-align: left;
                padding: 8px;
            }

            th {
                background-color: #f2f2f2;
            }

            @media print {
                body {
                    margin: 0;
                }

                table {
                    page-break-inside: auto;
                }

                tr {
                    page-break-inside: avoid;
                    page-break-after: auto;
                }

                thead {
                    display: table-header-group;
                }

                tfoot {
                    display: table-footer-group;
                }
            }
        </style>
        <center>
            <h2>Laporan Kinerja Analisis</h2>
            <table>
                <thead>
                    <tr>
                        <th rowspan="2">ID</th>
                        <th rowspan="2">User</th>
                        <th rowspan="2">Link</th>
                        <th colspan="3" style="text-align: center;">Analisa Sentimen</th>
                    </tr>
                    <tr>
                        <th>Positif</th>
                        <th>Negatif</th>
                        <th>Netral</th>
                    </tr>
                </thead>
                <tbody>
    `;

            // Add rows from the existing table to the print view
            var tableRows = document.querySelectorAll('#myTable tbody tr');
            tableRows.forEach(function (row, index) {
                printContent += `
            <tr>
                <td>${index + 1}</td>
                <td>${row.cells[1].textContent}</td>
                <td>${row.cells[2].textContent}</td>
                <td>${row.cells[3].textContent}</td>
                <td>${row.cells[4].textContent}</td>
                <td>${row.cells[5].textContent}</td>
            </tr>
        `;
            });

            // Close the table and add the signature column
            const date = new Date();
            const formattedDate =
                `${date.getDate()} ${date.toLocaleString('default', { month: 'short' })} ${date.getFullYear()}`;
            printContent += `
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="6">
                            Total Dataset       : {{total}}<br>
                            Total Data Analisis : {{total_analisis}}<br>
                            Kinerja User        : {{user_analisis_count}}/{{count_user}}
                        </td>
                    </tr>
                </tfoot>
            </table>
        </center>
        <div style="float: right; text-align: center; height: 5px;">
            <span>${formattedDate}</span>
            <br>
            <span>Diketahui,</span>
            <br>
            <br>
            <br>
            <br>
            <span>( {{admin}} )</span>
        </div>
    `;

            // Set the HTML content for the print view
            printWindow.document.write(printContent);

            // Close the document for printing
            printWindow.document.close();

            // Print the document
            printWindow.print();
        });
    </script>

    </body>

</html>